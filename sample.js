
//{"latitude":39.632927,"longitude":-86.16553,"generationtime_ms":0.7469654083251953,"utc_offset_seconds":0,"timezone":"GMT","timezone_abbreviation":"GMT","elevation":221.0,"current_weather":{"temperature":5.4,"windspeed":8.2,"winddirection":299.0,"weathercode":3,"time":"2022-12-11T18:00"}
//"hourly_units":{"time":"iso8601","temperature_2m":"Â°C"}
//"hourly":{"time":["2022-12-04T01:00","2022-12-04T02:00","2022-12-04T03:00","2022-12-04T04:00","2022-12-04T05:00","2022-12-04T06:00","2022-12-04T07:00","2022-12-04T08:00","2022-12-04T09:00","2022-12-04T10:00","2022-12-04T11:00","2022-12-04T12:00","2022-12-04T13:00","2022-12-04T14:00","2022-12-04T15:00","2022-12-04T16:00","2022-12-04T17:00","2022-12-04T18:00","2022-12-04T19:00","2022-12-04T20:00",
//"2022-12-04T21:00","2022-12-04T22:00","2022-12-04T23:00","2022-12-05T00:00","2022-12-05T01:00","2022-12-05T02:00","2022-12-05T03:00","2022-12-05T04:00","2022-12-05T05:00","2022-12-05T06:00","2022-12-05T07:00","2022-12-05T08:00","2022-12-05T09:00","2022-12-05T10:00","2022-12-05T11:00","2022-12-05T12:00","2022-12-05T13:00","2022-12-05T14:00","2022-12-05T15:00","2022-12-05T16:00",
//"2022-12-05T17:00","2022-12-05T18:00","2022-12-05T19:00","2022-12-05T20:00","2022-12-05T21:00","2022-12-05T22:00","2022-12-05T23:00","2022-12-06T00:00","2022-12-06T01:00","2022-12-06T02:00","2022-12-06T03:00","2022-12-06T04:00","2022-12-06T05:00","2022-12-06T06:00","2022-12-06T07:00","2022-12-06T08:00","2022-12-06T09:00","2022-12-06T10:00","2022-12-06T11:00","2022-12-06T12:00",
//"2022-12-06T13:00","2022-12-06T14:00","2022-12-06T15:00","2022-12-06T16:00","2022-12-06T17:00","2022-12-06T18:00","2022-12-06T19:00","2022-12-06T20:00","2022-12-06T21:00","2022-12-06T22:00","2022-12-06T23:00","2022-12-07T00:00","2022-12-07T01:00","2022-12-07T02:00","2022-12-07T03:00","2022-12-07T04:00","2022-12-07T05:00","2022-12-07T06:00","2022-12-07T07:00","2022-12-07T08:00",
//"2022-12-07T09:00","2022-12-07T10:00","2022-12-07T11:00","2022-12-07T12:00","2022-12-07T13:00","2022-12-07T14:00","2022-12-07T15:00","2022-12-07T16:00","2022-12-07T17:00","2022-12-07T18:00","2022-12-07T19:00","2022-12-07T20:00","2022-12-07T21:00","2022-12-07T22:00","2022-12-07T23:00","2022-12-08T00:00","2022-12-08T01:00","2022-12-08T02:00","2022-12-08T03:00","2022-12-08T04:00",
//"2022-12-08T05:00","2022-12-08T06:00","2022-12-08T07:00","2022-12-08T08:00","2022-12-08T09:00","2022-12-08T10:00","2022-12-08T11:00","2022-12-08T12:00","2022-12-08T13:00","2022-12-08T14:00","2022-12-08T15:00","2022-12-08T16:00","2022-12-08T17:00","2022-12-08T18:00","2022-12-08T19:00","2022-12-08T20:00","2022-12-08T21:00","2022-12-08T22:00","2022-12-08T23:00","2022-12-09T00:00",
//"2022-12-09T01:00","2022-12-09T02:00","2022-12-09T03:00","2022-12-09T04:00","2022-12-09T05:00","2022-12-09T06:00","2022-12-09T07:00","2022-12-09T08:00","2022-12-09T09:00","2022-12-09T10:00","2022-12-09T11:00","2022-12-09T12:00","2022-12-09T13:00","2022-12-09T14:00","2022-12-09T15:00","2022-12-09T16:00","2022-12-09T17:00","2022-12-09T18:00","2022-12-09T19:00","2022-12-09T20:00",
//"2022-12-09T21:00","2022-12-09T22:00","2022-12-09T23:00","2022-12-10T00:00","2022-12-10T01:00","2022-12-10T02:00","2022-12-10T03:00","2022-12-10T04:00","2022-12-10T05:00","2022-12-10T06:00","2022-12-10T07:00","2022-12-10T08:00","2022-12-10T09:00","2022-12-10T10:00","2022-12-10T11:00","2022-12-10T12:00","2022-12-10T13:00","2022-12-10T14:00","2022-12-10T15:00","2022-12-10T16:00",
//"2022-12-10T17:00","2022-12-10T18:00","2022-12-10T19:00","2022-12-10T20:00","2022-12-10T21:00","2022-12-10T22:00","2022-12-10T23:00","2022-12-11T00:00","2022-12-11T01:00","2022-12-11T02:00","2022-12-11T03:00","2022-12-11T04:00","2022-12-11T05:00","2022-12-11T06:00","2022-12-11T07:00","2022-12-11T08:00","2022-12-11T09:00","2022-12-11T10:00","2022-12-11T11:00","2022-12-11T12:00",
//"2022-12-11T13:00","2022-12-11T14:00","2022-12-11T15:00","2022-12-11T16:00","2022-12-11T17:00","2022-12-11T18:00","2022-12-11T19:00","2022-12-11T20:00","2022-12-11T21:00","2022-12-11T22:00","2022-12-11T23:00","2022-12-12T00:00","2022-12-12T01:00","2022-12-12T02:00","2022-12-12T03:00","2022-12-12T04:00","2022-12-12T05:00","2022-12-12T06:00","2022-12-12T07:00","2022-12-12T08:00",
//"2022-12-12T09:00","2022-12-12T10:00","2022-12-12T11:00","2022-12-12T12:00","2022-12-12T13:00","2022-12-12T14:00","2022-12-12T15:00","2022-12-12T16:00","2022-12-12T17:00","2022-12-12T18:00","2022-12-12T19:00","2022-12-12T20:00","2022-12-12T21:00","2022-12-12T22:00","2022-12-12T23:00","2022-12-13T00:00","2022-12-13T01:00","2022-12-13T02:00","2022-12-13T03:00","2022-12-13T04:00",
//"2022-12-13T05:00","2022-12-13T06:00","2022-12-13T07:00","2022-12-13T08:00","2022-12-13T09:00","2022-12-13T10:00","2022-12-13T11:00","2022-12-13T12:00","2022-12-13T13:00","2022-12-13T14:00","2022-12-13T15:00","2022-12-13T16:00","2022-12-13T17:00","2022-12-13T18:00","2022-12-13T19:00","2022-12-13T20:00","2022-12-13T21:00","2022-12-13T22:00","2022-12-13T23:00","2022-12-14T00:00",
//"2022-12-14T01:00","2022-12-14T02:00","2022-12-14T03:00","2022-12-14T04:00","2022-12-14T05:00","2022-12-14T06:00","2022-12-14T07:00","2022-12-14T08:00","2022-12-14T09:00","2022-12-14T10:00","2022-12-14T11:00","2022-12-14T12:00","2022-12-14T13:00","2022-12-14T14:00","2022-12-14T15:00","2022-12-14T16:00","2022-12-14T17:00","2022-12-14T18:00","2022-12-14T19:00","2022-12-14T20:00",
//"2022-12-14T21:00","2022-12-14T22:00","2022-12-14T23:00","2022-12-15T00:00","2022-12-15T01:00","2022-12-15T02:00","2022-12-15T03:00","2022-12-15T04:00","2022-12-15T05:00","2022-12-15T06:00","2022-12-15T07:00","2022-12-15T08:00","2022-12-15T09:00","2022-12-15T10:00","2022-12-15T11:00","2022-12-15T12:00","2022-12-15T13:00","2022-12-15T14:00","2022-12-15T15:00","2022-12-15T16:00",
//"2022-12-15T17:00","2022-12-15T18:00","2022-12-15T19:00","2022-12-15T20:00","2022-12-15T21:00","2022-12-15T22:00","2022-12-15T23:00","2022-12-16T00:00","2022-12-16T01:00","2022-12-16T02:00","2022-12-16T03:00","2022-12-16T04:00","2022-12-16T05:00","2022-12-16T06:00","2022-12-16T07:00","2022-12-16T08:00","2022-12-16T09:00","2022-12-16T10:00","2022-12-16T11:00","2022-12-16T12:00",
//"2022-12-16T13:00","2022-12-16T14:00","2022-12-16T15:00","2022-12-16T16:00","2022-12-16T17:00","2022-12-16T18:00","2022-12-16T19:00","2022-12-16T20:00","2022-12-16T21:00","2022-12-16T22:00","2022-12-16T23:00","2022-12-17T00:00","2022-12-17T01:00","2022-12-17T02:00","2022-12-17T03:00","2022-12-17T04:00","2022-12-17T05:00","2022-12-17T06:00","2022-12-17T07:00","2022-12-17T08:00",
//"2022-12-17T09:00","2022-12-17T10:00","2022-12-17T11:00","2022-12-17T12:00","2022-12-17T13:00","2022-12-17T14:00","2022-12-17T15:00","2022-12-17T16:00","2022-12-17T17:00","2022-12-17T18:00","2022-12-17T19:00","2022-12-17T20:00","2022-12-17T21:00","2022-12-17T22:00","2022-12-17T23:00","2022-12-18T00:00","2022-12-18T01:00","2022-12-18T02:00","2022-12-18T03:00","2022-12-18T04:00",
//"2022-12-18T05:00","2022-12-18T06:00","2022-12-18T07:00","2022-12-18T08:00","2022-12-18T09:00","2022-12-18T10:00","2022-12-18T11:00","2022-12-18T12:00","2022-12-18T13:00","2022-12-18T14:00","2022-12-18T15:00","2022-12-18T16:00","2022-12-18T17:00","2022-12-18T18:00","2022-12-18T19:00","2022-12-18T20:00","2022-12-18T21:00","2022-12-18T22:00","2022-12-18T23:00","2022-12-19T00:00",
//"2022-12-19T01:00","2022-12-19T02:00","2022-12-19T03:00","2022-12-19T04:00","2022-12-19T05:00","2022-12-19T06:00","2022-12-19T07:00","2022-12-19T08:00","2022-12-19T09:00","2022-12-19T10:00","2022-12-19T11:00","2022-12-19T12:00","2022-12-19T13:00","2022-12-19T14:00","2022-12-19T15:00","2022-12-19T16:00","2022-12-19T17:00","2022-12-19T18:00","2022-12-19T19:00","2022-12-19T20:00",
//"2022-12-19T21:00","2022-12-19T22:00","2022-12-19T23:00","2022-12-20T00:00","2022-12-20T01:00","2022-12-20T02:00","2022-12-20T03:00","2022-12-20T04:00","2022-12-20T05:00","2022-12-20T06:00","2022-12-20T07:00","2022-12-20T08:00","2022-12-20T09:00","2022-12-20T10:00","2022-12-20T11:00","2022-12-20T12:00","2022-12-20T13:00","2022-12-20T14:00","2022-12-20T15:00","2022-12-20T16:00",
//"2022-12-20T17:00","2022-12-20T18:00","2022-12-20T19:00","2022-12-20T20:00","2022-12-20T21:00","2022-12-20T22:00","2022-12-20T23:00","2022-12-21T00:00","2022-12-21T01:00","2022-12-21T02:00","2022-12-21T03:00","2022-12-21T04:00","2022-12-21T05:00","2022-12-21T06:00","2022-12-21T07:00","2022-12-21T08:00","2022-12-21T09:00","2022-12-21T10:00","2022-12-21T11:00","2022-12-21T12:00",
//"2022-12-21T13:00","2022-12-21T14:00","2022-12-21T15:00","2022-12-21T16:00","2022-12-21T17:00","2022-12-21T18:00","2022-12-21T19:00","2022-12-21T20:00","2022-12-21T21:00","2022-12-21T22:00","2022-12-21T23:00","2022-12-22T00:00","2022-12-22T01:00","2022-12-22T02:00","2022-12-22T03:00","2022-12-22T04:00","2022-12-22T05:00","2022-12-22T06:00","2022-12-22T07:00","2022-12-22T08:00",
//"2022-12-22T09:00","2022-12-22T10:00","2022-12-22T11:00","2022-12-22T12:00","2022-12-22T13:00","2022-12-22T14:00","2022-12-22T15:00","2022-12-22T16:00","2022-12-22T17:00","2022-12-22T18:00","2022-12-22T19:00","2022-12-22T20:00","2022-12-22T21:00","2022-12-22T22:00","2022-12-22T23:00","2022-12-23T00:00","2022-12-23T01:00","2022-12-23T02:00","2022-12-23T03:00","2022-12-23T04:00",
//"2022-12-23T05:00","2022-12-23T06:00","2022-12-23T07:00","2022-12-23T08:00","2022-12-23T09:00","2022-12-23T10:00","2022-12-23T11:00","2022-12-23T12:00","2022-12-23T13:00","2022-12-23T14:00","2022-12-23T15:00","2022-12-23T16:00","2022-12-23T17:00","2022-12-23T18:00","2022-12-23T19:00","2022-12-23T20:00","2022-12-23T21:00","2022-12-23T22:00","2022-12-23T23:00","2022-12-24T00:00",
//"2022-12-24T01:00","2022-12-24T02:00","2022-12-24T03:00","2022-12-24T04:00","2022-12-24T05:00","2022-12-24T06:00","2022-12-24T07:00","2022-12-24T08:00","2022-12-24T09:00","2022-12-24T10:00","2022-12-24T11:00","2022-12-24T12:00","2022-12-24T13:00","2022-12-24T14:00","2022-12-24T15:00","2022-12-24T16:00","2022-12-24T17:00","2022-12-24T18:00","2022-12-24T19:00","2022-12-24T20:00",
//"2022-12-24T21:00","2022-12-24T22:00","2022-12-24T23:00","2022-12-25T00:00","2022-12-25T01:00","2022-12-25T02:00","2022-12-25T03:00","2022-12-25T04:00","2022-12-25T05:00","2022-12-25T06:00","2022-12-25T07:00","2022-12-25T08:00","2022-12-25T09:00","2022-12-25T10:00","2022-12-25T11:00","2022-12-25T12:00","2022-12-25T13:00","2022-12-25T14:00","2022-12-25T15:00","2022-12-25T16:00",
//"2022-12-25T17:00","2022-12-25T18:00","2022-12-25T19:00","2022-12-25T20:00","2022-12-25T21:00","2022-12-25T22:00","2022-12-25T23:00","2022-12-26T00:00","2022-12-26T01:00","2022-12-26T02:00","2022-12-26T03:00","2022-12-26T04:00","2022-12-26T05:00","2022-12-26T06:00","2022-12-26T07:00","2022-12-26T08:00","2022-12-26T09:00","2022-12-26T10:00","2022-12-26T11:00","2022-12-26T12:00",
//"2022-12-26T13:00","2022-12-26T14:00","2022-12-26T15:00","2022-12-26T16:00","2022-12-26T17:00","2022-12-26T18:00","2022-12-26T19:00","2022-12-26T20:00","2022-12-26T21:00","2022-12-26T22:00","2022-12-26T23:00"],
//"temperature_2m":[5.2,1.9,0.6,0.8,1.1,2.0,2.8,2.9,3.0,2.6,1.8,-0.1,-1.3,-2.0,-4.0,-4.4,-4.5,-4.4,-5.1,-5.5,-5.6,-6.0,-5.7,-5.6,-5.2,-5.6,-4.7,-1.9,0.4,2.2,3.6,4.6,5.1,5.1,3.6,1.4,-0.3,-1.1,-2.4,-2.7,-2.8,-2.6,-3.1,-3.5,-3.6,-3.7,-3.7,-3.6,-3.0,-2.8,-1.4,1.4,2.5,3.8,5.5,5.7,6.9,6.2,5.7,5.9,5.8,5.8,5.8,5.5,5.2,5.2,5.2,5.2,5.1,5.1,5.3,5.2,5.5,5.5,5.7,6.1,7.1,8.3,9.5,10.3,10.3,10.2,9.8,9.5,9.0,9.0,9.0,8.5,8.4,8.4,8.1,8.3,8.2,8.2,7.9,7.7,7.4,7.3,7.1,6.9,7.3,7.1,7.6,7.6,8.2,8.3,8.1,8.2,7.9,6.3,5.4,4.7,4.0,3.8,4.0,4.7,5.3,5.5,5.6,5.8,5.5,5.7,5.8,6.3,6.3,6.5,7.2,7.1,6.7,6.4,6.6,6.3,6.3,6.0,5.4,4.9,4.7,5.1,5.4,5.4,5.3,5.1,4.8,4.6,4.4,4.1,4.2,4.7,5.8,6.1,6.2,6.8,7.3,7.2,7.1,7.2,7.2,7.3,7.3,7.3,7.2,7.1,6.4,6.2,5.8,5.9,5.1,4.4,4.7,4.8,4.6,4.8,4.9,5.3,5.6,6.1,6.5,6.6,6.4,6.8,5.9,5.7,5.7,5.5,5.4,5.5,5.1,5.4,5.4,5.2,5.2,5.1,5.3,5.3,5.2,5.2,5.4,5.5,5.4,5.7,5.5,5.5,4.7,4.1,3.7,3.5,3.4,3.5,3.2,3.1,2.9,2.7,2.6,2.6,2.5,1.9,1.8,1.6,2.1,3.0,3.5,3.0,3.3,3.5,4.0,3.6,3.3,2.7,2.1,0.8,0.9,0.1,-0.4,0.1,0.1,-0.2,0.2,-0.1,0.1,0.4,0.3,0.4,0.8,1.9,3.5,5.0,6.4,7.4,7.7,7.3,6.9,6.4,6.1,5.9,5.8,5.8,5.9,6.0,6.1,6.5,6.7,7.0,6.3,6.5,6.9,7.4,7.9,7.7,8.0,8.4,8.6,9.0,9.2,9.4,9.4,9.9,10.0,10.1,10.1,10.2,10.4,10.2,10.0,9.9,10.0,9.8,8.1,6.4,5.6,4.8,4.8,5.6,6.6,7.2,7.6,7.9,7.9,7.4,6.4,5.4,4.6,4.1,3.7,3.2,2.8,2.5,2.1,2.0,1.9,2.0,2.0,1.9,1.7,1.8,1.9,2.1,2.4,2.7,2.9,2.7,2.3,1.6,1.1,0.5,-0.2,-0.6,-0.9,-1.1,-1.2,-1.3,-1.4,-1.4,-1.5,-1.7,-2.2,-2.7,-3.3,-3.5,-3.5,-3.3,-2.8,-2.1,-1.3,-1.0,-0.7,-0.7,-1.1,-1.6,-2.3,-2.6,-2.8,-3.1,-3.3,-3.4,-3.7,-3.9,-4.1,-4.3,-4.5,-4.7,-4.8,-4.7,-4.6,-4.3,-3.7,-3.0,-2.2,-1.9,-1.6,-1.6,-1.9,-2.3,-2.9,-3.1,-3.1,-3.3,-3.4,-3.6,-3.8,-4.0,-4.2,-4.5,-4.7,-5.0,-5.2,-5.1,-4.9,-4.4,-3.8,-3.0,-2.3,-2.1,-2.1,-2.3,-2.7,-3.1,-3.8,-4.2,-4.6,-5.0,-5.3,-5.5,-5.9,-6.5,-7.2,-8.1,-8.6,-9.1,-9.5,-9.7,-9.8,-9.8,-9.4,-8.8,-8.1,-7.7,-7.4,-7.2,-7.3,-7.6,-8.0,-8.2,-8.4,-8.6,-8.7,-8.8,-8.9,-9.1,-9.2,-9.4,-9.6,-9.7,-9.8,-9.7,-9.5,-8.9,-8.0,-6.9,-5.7,-5.2,-4.8,-4.6,-4.8,-5.3,-5.8,-6.1,-6.2,-6.4,-6.5,-6.6,-6.7,-6.8,-6.8,-6.8,-6.7,-6.7,-6.4,-6.1,-5.7,-4.9,-4.2,-3.3,-2.3,-1.8,-1.6,-1.5,-1.6,-1.9,-2.3,-2.5,-2.7,-2.9,-3.0,-3.1,-3.1,-3.2,-3.3,-3.5,-3.6,-3.8,-4.0,-4.2,-4.3,-4.4,-4.3,-4.2,-4.2,-4.7,-5.3,-6.3,-6.9,-7.6,-8.4,-9.1,-9.7,-10.4,-10.9,-11.3,-11.9,-12.3,-12.7,-13.1,-13.4,-13.7,-13.9,-14.0,-14.0,-13.7,-13.2,-12.5,-11.7,-11.3,-11.1,-10.9,-11.0,-11.2,-11.6,-11.8,-12.0,-12.3,-12.5,-12.7,-12.8,-12.8,-12.7,-12.6,-12.5,-12.5,-12.4,-12.4,-12.5,-12.3,-11.9,-11.2,-10.4,-9.9,-9.4,-9.1,-9.2,-9.6,-10.2,-10.5,-10.7,-11.1,-11.3,-11.4,-11.6,-11.8,-12.0,-12.2,-12.3,-12.4,-12.5,-12.4,-12.3,-12.0,-11.7,-11.3,-10.9,-10.7,-10.7,-10.7,-10.7,-10.7]}}
//'https://api.open-meteo.com/v1/forecast?latitude=39.62&longitude=-86.16&hourly=temperature_2m');

function extract_date(time_el) {
    let day_str = time_el.match(/[^T]*/);
    return day_str;
}

function get_average(arr) {
    let msum = arr.reduce( (x,y) => x + y);
    return parseFloat(msum) / parseFloat(arr.length);
}

function make_temp_obj(timesg, tempsg) {
    let new_object = {};
    for (let i = 0; i < timesg.length; i++) {
        let exdate = extract_date(timesg[i]);
        if (exdate in new_object === false) {
            new_object[exdate] = [];
        }
        new_object[exdate].push(tempsg[i]);
    }
    return new_object;
}

function reg_text_insert(day, value, col) {
    //Elements
    const temp_comp = document.querySelector( '[id=weather-' + day + '-temp]'   );
    const svg_comp  = document.querySelector( '[id=weather-' + day + '-svg]'    );
    const cir_comp  = document.querySelector( '[id=weather-' + day + '-circle]' );

    temp_comp.innerHTML = value;
    cir_comp.setAttribute("fill", col);
}

function temp_in_html() {
    const jsong     = JSON.parse(this.responseText);
    const timesg    = jsong["hourly"]["time"];
    const tempsg    = jsong["hourly"]["temperature_2m"];
    const weekdays  = {1: "Monday", 2: "Tuesday", 3: "Wednesday", 4: "Thursday", 5: "Friday"};
    const weekends  = {"Sundays": 0, "Saturdays": 6};
    const temp_obj  = make_temp_obj(timesg, tempsg);

    let newbie_folk = {"Monday": null, "Tuesday": null, "Wednesday": null, "Thursday": null, "Friday": null};


    for (let key in temp_obj) {

        let c_date = new Date(key);
        let day_num = c_date.getDay();
        let tnum = temp_obj[key];

        if (day_num in weekdays) {
            const avr = get_average(tnum);
            const rnded = Math.round(avr);
            const col = rnded > 2 ? "#FFC600" : "#3399FF";

            newbie_folk[weekdays[day_num]] = {"Average": avr, "Temps": tnum};
            reg_text_insert(weekdays[day_num].toLowerCase(), rnded.toString() + '&#176;', col); 
        }
    }
}

function main() {

    const latit =  '39.6329'
    const longi = '-86.1655'

    //          protocol     domain                 suburl
    let murl = 'https://' + 'api.open-meteo.com' + '/v1/forecast' +
               '?latitude='         +           latit  +
               '&longitude='        +           longi  +
               '&hourly='           + 'temperature_2m' + 
               '&current_weather='  +           'true' ;

    let req = new XMLHttpRequest();

    req.open(method="GET", URL=murl, ASYNC=true);

    req.onload = temp_in_html;

    req.send();
}

document.addEventListener("DOMContentLoaded", main);

